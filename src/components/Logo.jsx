import { useState, useEffect } from 'react'
import { motion } from 'framer-motion'


const paths = [
    'M130.631 130.626C130.633 130.63 130.639 130.628 130.639 130.624V130.624C130.639 130.62 130.644 130.618 130.647 130.622L158.658 172.767C161.113 176.945 163.793 180.976 166.684 184.84L173.226 194.684C173.989 195.832 174.396 197.18 174.396 198.558V206.715C174.396 210.581 171.262 213.715 167.396 213.715H134.39C132.047 213.715 129.859 212.542 128.561 210.591L56.5865 102.366C52.7489 96.5957 43.7578 99.3125 43.7578 106.242V206.715C43.7578 210.581 40.6238 213.715 36.7578 213.715H7C3.13401 213.715 0 210.581 0 206.715V7C0 3.13401 3.13401 0 7 0H40.0065C42.3497 0 44.5376 1.17247 45.8352 3.12364L130.631 130.626ZM174.396 16.8103C174.396 18.5447 173.747 20.2121 172.61 21.5224C156.924 39.6127 146.136 62.067 142.316 86.8209C141.525 91.9439 134.395 93.8709 131.525 89.5538V89.5538C130.947 88.6838 130.639 87.6625 130.639 86.6179V7C130.639 3.13401 133.773 0 137.639 0H167.396C171.262 0 174.396 3.13401 174.396 7V16.8103Z',
    'M271.107 0C330.123 0.00021224 377.965 47.8418 377.965 106.857C377.965 165.873 330.123 213.715 271.107 213.715C212.092 213.715 164.25 165.873 164.25 106.857C164.25 47.8417 212.092 0 271.107 0ZM271.107 43.7578C236.258 43.7578 208.008 72.0084 208.008 106.857C208.008 141.706 236.258 169.957 271.107 169.957C305.956 169.957 334.207 141.706 334.207 106.857C334.207 72.0084 305.956 43.7579 271.107 43.7578Z',
    'M505.945 0C512.79 0 515.989 9.4018 511.123 14.2161C503.301 21.9554 496.454 30.6782 490.783 40.1842C489.479 42.3692 487.148 43.7578 484.604 43.7578H465.502C461.636 43.7578 458.502 46.8918 458.502 50.7578V206.715C458.502 210.581 455.368 213.715 451.502 213.715H421.744C417.878 213.715 414.744 210.581 414.744 206.715V50.7578C414.744 46.8918 411.61 43.7578 407.744 43.7578H389.281C386.737 43.7578 384.406 42.3692 383.102 40.1842C377.431 30.6782 370.584 21.9554 362.761 14.2161C357.895 9.40178 361.094 0 367.939 0H505.945Z',
    'M646.854 36.7578C646.854 40.6238 643.72 43.7578 639.854 43.7578H600.56C600.56 43.7578 600.56 43.758 600.56 43.7583V43.7583C600.56 43.7586 600.559 43.7588 600.559 43.7588C600.454 43.7583 600.349 43.7578 600.244 43.7578C565.395 43.7578 537.145 72.0084 537.145 106.857C537.145 141.706 565.395 169.957 600.244 169.957C600.349 169.957 600.454 169.956 600.559 169.955C600.559 169.955 600.56 169.956 600.56 169.956V169.956C600.56 169.957 600.56 169.957 600.561 169.957H639.854C643.72 169.957 646.854 173.091 646.854 176.957V206.715C646.854 210.581 643.72 213.715 639.854 213.715H600.56C600.559 213.715 600.559 213.714 600.559 213.713V213.713C600.559 213.713 600.558 213.712 600.557 213.712C600.453 213.712 600.349 213.715 600.244 213.715C541.228 213.715 493.387 165.873 493.387 106.857C493.387 47.8417 541.228 0 600.244 0C600.349 3.84221e-06 600.453 0.000665547 600.558 0.000975118C600.558 0.000975917 600.559 0.000757396 600.559 0.000487561V0.000487561C600.559 0.000218289 600.559 0 600.559 0H639.854C643.72 0 646.854 3.13401 646.854 7V36.7578Z',
    'M714.074 77.9785C714.074 81.8445 717.208 84.9785 721.074 84.9785H797.761C801.627 84.9785 804.761 81.8445 804.761 77.9785V7C804.761 3.134 807.895 0 811.761 0H841.519C845.385 0 848.519 3.13401 848.519 7V206.715C848.519 210.581 845.385 213.715 841.519 213.715H811.761C807.895 213.715 804.761 210.581 804.761 206.715V135.736C804.761 131.87 801.627 128.736 797.761 128.736H721.074C717.208 128.736 714.074 131.87 714.074 135.736V206.715C714.074 210.581 710.94 213.715 707.074 213.715H677.316C673.45 213.715 670.316 210.581 670.316 206.715V7C670.316 3.13401 673.45 0 677.316 0H707.074C710.94 0 714.074 3.13401 714.074 7V77.9785Z',
    'M940.963 106.814C941.057 106.975 941.106 107.158 941.106 107.344V107.344C941.106 108.4 942.49 108.796 943.049 107.899L1008.18 3.30008C1009.45 1.24766 1011.7 0 1014.12 0H1046.99C1050.86 0 1053.99 3.13401 1053.99 7V206.715C1053.99 210.581 1050.86 213.715 1046.99 213.715H1017.23C1013.37 213.715 1010.23 210.581 1010.23 206.715V109.352C1010.23 102.312 1001.01 99.6765 997.288 105.654L959.333 166.655C958.055 168.709 955.808 169.957 953.389 169.957H928.957C926.467 169.957 924.164 168.634 922.91 166.483L872.935 80.7699C872.311 79.6997 871.982 78.483 871.982 77.2441V14.4729C871.982 7.32811 881.428 4.77407 885.029 10.9453L940.963 106.814Z',
    'M1161 0H1085C1081.13 0 1078 3.13401 1078 7V37C1078 40.866 1081.13 44 1085 44H1161C1164.87 44 1168 40.866 1168 37V7C1168 3.13401 1164.87 0 1161 0Z',
    'M1161 85H1085C1081.13 85 1078 88.134 1078 92V122C1078 125.866 1081.13 129 1085 129H1161C1164.87 129 1168 125.866 1168 122V92C1168 88.134 1164.87 85 1161 85Z',
    'M1161 170H1085C1081.13 170 1078 173.134 1078 177V207C1078 210.866 1081.13 214 1085 214H1161C1164.87 214 1168 210.866 1168 207V177C1168 173.134 1164.87 170 1161 170Z',
    'M1231.61 0C1233.95 0 1236.14 1.17247 1237.44 3.12364L1309.41 111.349C1313.25 117.119 1322.24 114.402 1322.24 107.472V7C1322.24 3.13401 1325.38 0 1329.24 0H1359C1362.87 0 1366 3.13401 1366 7V206.715C1366 210.581 1362.87 213.715 1359 213.715H1325.99C1323.65 213.715 1321.46 212.542 1320.16 210.591L1248.19 102.366C1244.35 96.5957 1235.36 99.3125 1235.36 106.242V206.715C1235.36 210.581 1232.23 213.715 1228.36 213.715H1198.6C1194.74 213.715 1191.6 210.581 1191.6 206.715V7C1191.6 3.13401 1194.74 0 1198.6 0H1231.61Z',
]
const dirs = [
    2,
    3,
    0,
    1,
    2,
    0,
    1,
    1,
    1,
    2
]
const ORIGINAL_W = 1366
const ORIGINAL_H = 214
const MAX_DISPLACEMENT = 100

function getOffset(i, axis, scaleX = 1, scaleY = 1) {
    let dist = MAX_DISPLACEMENT
    let dir = dirs[i]
    // 0=UP 1=RIGHT 2=DOWN 3=LEFT
    // axis 0=x 1=y

    if (axis === 0) { // x
        if (dir === 1) {
            return dist * scaleX
        } else if (dir === 3) {
            return -dist * scaleX
        }
    } else { // y
        if (dir === 0) {
            return -dist * scaleY
        } else if (dir === 2) {
            return dist * scaleY
        }
    }
    return 0
}

export default function Logo({ active }) {
    const [w, setW] = useState(ORIGINAL_W)
    const [h, setH] = useState(ORIGINAL_H)

    useEffect(() => {
        function handleResize() {
            const newW = Math.max(500, window.innerWidth / 1.5)
            const newH = newW / 6.383
            setW(newW)
            setH(newH)
        }
        handleResize()
        window.addEventListener('resize', handleResize)
        return () => window.removeEventListener('resize', handleResize)
    }, [])

    const scaleX = w / ORIGINAL_W
    const scaleY = h / ORIGINAL_H
    const PADDING = MAX_DISPLACEMENT
    const paddedViewBox = `${0} ${0} ${ORIGINAL_W + 2 * PADDING} ${ORIGINAL_H + 2 * PADDING}`

    return (
        <svg
            width={w}
            height={h}
            viewBox={paddedViewBox}
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
        >
            <g transform={`translate(${PADDING},${PADDING})`}>
                {paths.map((d, i) => (
                    <motion.path
                        fill='black'
                        d={d}
                        key={i}
                        initial={{ opacity: 0 }}
                        animate={{
                            opacity: active ? 1 : 0,
                            x: active ? 0 : getOffset(i, 0, scaleX, scaleY),
                            y: active ? 0 : getOffset(i, 1, scaleX, scaleY)
                        }}
                        transition={{ duration: 0.7, delay: i * 0.1, type: 'spring' }}
                    />
                ))}
            </g>
        </svg>
    )
}